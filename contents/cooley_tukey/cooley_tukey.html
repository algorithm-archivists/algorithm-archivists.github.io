
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>FFT Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-bibtex-cite/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../decision_problems/decision_problems.html" />
    
    
    <link rel="prev" href="../graham_scan/graham_scan.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="../introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="../how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../plotting/plotting.html">
            
                <a href="../plotting/plotting.html">
            
                    
                    Plotting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../data_structures/data_structures.html">
            
                <a href="../data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="../stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="../mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../notation/notation.html">
            
                <a href="../notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../bitlogic/bitlogic.html">
            
                <a href="../bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="../taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../sorting_and_searching/sorting_and_searching.html">
            
                <a href="../sorting_and_searching/sorting_and_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../bubble_sort/bubble_sort.html">
            
                <a href="../bubble_sort/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../bogo_sort/bogo_sort.html">
            
                <a href="../bogo_sort/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="../tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="../euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="../monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="../matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="../gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="../thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="../computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="../gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="../jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="../graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.13" data-path="cooley_tukey.html">
            
                <a href="cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../decision_problems/decision_problems.html">
            
                <a href="../decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="../stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../differential_equations/differential_equations.html">
            
                <a href="../differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../forward_euler_method/forward_euler_method.html">
            
                <a href="../forward_euler_method/forward_euler_method.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="../physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../verlet_integration/verlet_integration.html">
            
                <a href="../verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="../quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="../split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../data_compression/data_compression.html">
            
                <a href="../data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="../huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../quantum_information/quantum_information.html">
            
                <a href="../quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../computus/computus.html">
            
                <a href="../computus/computus.html">
            
                    
                    Computus
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >FFT</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="what-makes-a-fourier-transform-fast">What Makes a Fourier Transform Fast?</h2>
<p>If there were ever an algorithm to radically change the landscape of computer science and engineering by making seemingly impossible problems possible, it would be the Fast Fourier Transform (FFT).
On the surface, the algorithm seems like a simple application of recursion, and in principle, that is exactly what it is; however, the Fourier Transform is no ordinary transform -- it allows researchers and engineers to easily bounce back and forth between real space and frequency space and is the heart of many physics and engineering applications.
From calculating superfluid vortex positions to super-resolution imaging, Fourier Transforms lay at the heart of many scientific disciplines and are essential to many algorithms we will cover later in this book.</p>
<p>Simply put, the Fourier Transform is a beautiful application of complex number systems; however, it would rarely be used today if not for the ability to quickly perform the operation with Fast Fourier Transform, first introduced by the great Frederick Gauss in 1805 and later independently discovered by James Cooley and John Tukey in 1965 <a href="#cite-1">[1]</a>.
Gauss (of course) already had too many things named after him and Cooley and Tukey both had cooler names, so the most common algorithm for FFT&apos;s today is known as the Cooley-Tukey algorithm.</p>
<h3 id="what-is-a-fourier-transform">What is a Fourier Transform?</h3>
<p>To an outsider, the Fourier Transform looks like a mathematical mess -- certainly a far cry from the heroic portal between two domains I have depicted it to be; however, like most things, it&apos;s not as bad as it initially appears to be.
So, here it is in all it&apos;s glory!</p>
<p><script type="math/tex; ">F(\xi) = \int_{-\infty} ^\infty f(x) e^{-2 \pi i x \xi} dx</script></p>
<p>and</p>
<p><script type="math/tex; ">f(x) = \int_{-\infty} ^\infty F(\xi) e^{2 \pi i \xi x} d\xi</script></p>
<p>Where <script type="math/tex; ">F(\xi)</script> represents a function in frequency space, <script type="math/tex; ">\xi</script> represents a value in frequency space, <script type="math/tex; ">f(x)</script> represents a function in real space, and <script type="math/tex; ">x</script> represents a value in the real space.
Note here that the only difference between the two exponential terms is a minus sign in the transformation to frequency space.
As I mentioned, this is not intuitive syntax, so please allow me to explain a bit.</p>
<p>Firstly, <strong>what does the Fourier Transform do?</strong></p>
<p>If we take a sum sinusoidal functions (like <script type="math/tex; ">\sin(\omega t)</script> or <script type="math/tex; ">\cos(\omega t)</script>), we might find a complicated mess of waves between <script type="math/tex; ">\pm 1</script>.
Each constituent wave can be described by only one value: <script type="math/tex; ">\omega</script>.
So, instead of representing these curves as seen above, we could instead describe them as peaks in frequency space, as shown below.</p>
<p>
    <img class="center" src="res/FT_example.png" width="500">
</p>

<p>This is what the Fourier Transform does!
After performing the transform, it is now much, much easier to understand precisely which frequencies are in our waveform, which is essential to most areas of signal processing.</p>
<p>Now, how does this relate to the transformations above?
Well, the easiest way is to substitute in the Euler&apos;s formula:</p>
<p><script type="math/tex; ">e^{2 \pi i \theta} = \cos(2 \pi \theta) + i \sin(2 \pi \theta)</script></p>
<p>This clearly turns our function in frequency space into:</p>
<p><script type="math/tex; ">F(\xi) = \int_{-\infty} ^\infty f(x) (\cos(-2 \pi x \xi) + i \sin(-2 \pi x \xi))dx</script></p>
<p>and our function in real space into:</p>
<p><script type="math/tex; ">f(x) = \int_{-\infty} ^\infty F(\xi) (\cos(2 \pi \xi x) + i \sin(2 \pi \xi x)) d\xi</script></p>
<p>Here, the <script type="math/tex; ">\sin</script> and <script type="math/tex; ">\cos</script> functions are clearly written in the formulas, so it looks much friendlier, right?
This means that a point in real space is defined by the integral over all space of it&apos;s corresponding frequency function multiplied by sinusoidal oscillations.</p>
<p>Truth be told, even after seeing this math, I still didn&apos;t understand Fourier Transforms.
Truth be told, I didn&apos;t understand it fully until I discretized real and frequency space to create the Discrete Fourier Transform (DFT), which is the only way to implement Fourier Transforms in code.</p>
<h3 id="what-is-a-discrete-fourier-transform">What is a Discrete Fourier Transform?</h3>
<p>In principle, the Discrete Fourier Transform (DFT) is simply the Fourier transform with summations instead of integrals:</p>
<p><script type="math/tex; ">X_k = \sum_{n=0}^{N-1} x_n \cdot e^{-2 \pi i k n / N}</script></p>
<p>and</p>
<p><script type="math/tex; ">x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \cdot e^{2 \pi i k n / N}</script></p>
<p>Where <script type="math/tex; ">X_n</script> and <script type="math/tex; ">x_n</script> are sequences of <script type="math/tex; ">N</script> numbers in frequency and real space, respectively.
In principle, this is no easier to understand than the previous case!
For some reason, though, putting code to this transformation really helped me figure out what was actually going on.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> DFT<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token comment"># We want two vectors here for real space (n) and frequency space (k)</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    k <span class="token operator">=</span> n&apos;
    transform_matrix <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">*</span>k<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> transform_matrix<span class="token operator">*</span>x

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">dft</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> <span class="token keyword">const</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> complex tmp<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">cexp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> M_PI <span class="token operator">*</span> I <span class="token operator">*</span> j <span class="token operator">*</span> i <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">memcpy</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> tmp<span class="token punctuation">,</span> N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="clj" data-name="Clojure"><pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">defn</span> dft
  <span class="token string">&quot;take a vector of real numbers and return a vector of frequency
  space&quot;</span>
  <span class="token punctuation">[</span>vx<span class="token punctuation">]</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>len <span class="token punctuation">(</span><span class="token keyword">count</span> vx<span class="token punctuation">)</span><span class="token punctuation">]</span>
     <span class="token punctuation">(</span>matrix-mult
      <span class="token punctuation">(</span>partition len
                 <span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token punctuation">[</span>n <span class="token punctuation">(</span><span class="token keyword">range</span> len<span class="token punctuation">)</span>
                       k <span class="token punctuation">(</span><span class="token keyword">range</span> len<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token comment">;; expresion below is</span>
                   <span class="token comment">;; e^(n*k*2*pi*(1/len)*(-i))</span>
                   <span class="token punctuation">(</span><span class="token number">c</span>/exp <span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">*</span> n k
                               <span class="token number">2</span> Math/PI
                               <span class="token punctuation">(</span><span class="token keyword">/</span> len<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token number">c</span>/complex <span class="token number">0</span> -<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      vx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">dft</span><span class="token punctuation">(</span>Iter X<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">auto</span> N <span class="token operator">=</span> last <span class="token operator">-</span> X<span class="token punctuation">;</span>
  std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span> <span class="token function">tmp</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  std<span class="token operator">::</span><span class="token function">copy</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">begin</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">end</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">dft</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span>
<span class="token hvariable">dft</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">matMult</span> <span class="token hvariable">dftMat</span> <span class="token hvariable">x</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">length</span> <span class="token hvariable">x</span>
    <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token builtin">exp</span> <span class="token operator">$</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pi</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">:+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span>
    <span class="token hvariable">dftMat</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token hvariable">w</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token hvariable">j</span> <span class="token operator">*</span> <span class="token hvariable">k</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token hvariable">matMult</span> <span class="token hvariable">m</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator"> . </span><span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">dft</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> N
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
            temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> i <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> temp
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> DFT<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token comment"># We want two vectors here for real space (n) and frequency space (k)</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    k <span class="token operator">=</span> n&apos;
    transform_matrix <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">*</span>k<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> transform_matrix<span class="token operator">*</span>x

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">dft:</span>
  push   <span class="token register variable">rbx</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>                    # Save parameters
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  sub    <span class="token register variable">rsp</span>, <span class="token register variable">r13</span>                    # Make a double complex array
  xor    <span class="token register variable">r14</span>, <span class="token register variable">r14</span>                    # Set index to <span class="token number">0</span>
<span class="token label function">dft_loop_i:</span>
  cmp    <span class="token register variable">r14</span>, <span class="token register variable">r13</span>                    # Check if index is equal to array size
  je     dft_end_i
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>            # Set tmp array to zero at <span class="token register variable">r14</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token number">0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token number">0</span>
  xor    <span class="token register variable">r15</span>, <span class="token register variable">r15</span>                    # Set second index to <span class="token number">0</span>
<span class="token label function">dft_loop_j:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">r13</span>                    # Check if the index is equal to array size
  je     dft_end_j
  movsd  <span class="token register variable">xmm1</span>, two_pi                # Calculate <span class="token register variable">xmm1</span> <span class="token operator">=</span> <span class="token operator">-</span>2pi <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N
  mov    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>
  imul   <span class="token register variable">rax</span>, <span class="token register variable">r15</span>
  shr    <span class="token register variable">rax</span>, <span class="token number">4</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">rax</span>
  mulsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">r13</span>
  divsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  pxor   <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Set <span class="token register variable">xmm0</span> to <span class="token number">0</span>
  call   cexp
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r15</span><span class="token operator">]</span>            # Calculate X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">*</span> cexp(<span class="token operator">-</span>2pi <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N)
  movsd  <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   __muldc3
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm6</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>       # Sum to tmp array
  movsd  <span class="token register variable">xmm7</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm0</span>
  addsd  <span class="token register variable">xmm7</span>, <span class="token register variable">xmm1</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token register variable">xmm6</span>       # Save to tmp array
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm7</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    dft_loop_j
<span class="token label function">dft_end_j:</span>
  add    <span class="token register variable">r14</span>, <span class="token number">16</span>
  jmp    dft_loop_i
<span class="token label function">dft_end_i:</span>
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">r12</span>                    # Move tmp array to array ptr
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">rsp</span>
  mov    <span class="token register variable">rdx</span>, <span class="token register variable">r13</span>
  call   memcpy
  add    <span class="token register variable">rsp</span>, <span class="token register variable">r13</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  pop    <span class="token register variable">rbx</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">dft</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  <span class="token comment">// Initialize an array with N elements, filled with 0s</span>
  <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">temp<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Reduce x into the sum of x_k * exp(-2*sqrt(-1)*pi*i*k/N)</span>
      <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> k</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> i <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Start accumulating from 0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<p>In this function, we define <code>n</code> to be a set of integers from <script type="math/tex; ">0 \rightarrow N-1</script> and arrange them to be a column.
We then set <code>k</code> to be the same thing, but in a row.
This means that when we multiply them together, we get a matrix, but not just any matrix!
This matrix is the heart to the transformation itself!</p>
<pre class="language-"><code>M = [1.0+0.0im  1.0+0.0im           1.0+0.0im          1.0+0.0im;
     1.0+0.0im  6.12323e-17-1.0im  -1.0-1.22465e-16im -1.83697e-16+1.0im;
     1.0+0.0im -1.0-1.22465e-16im   1.0+2.44929e-16im -1.0-3.67394e-16im;
     1.0+0.0im -1.83697e-16+1.0im  -1.0-3.67394e-16im  5.51091e-16-1.0im]
</code></pre><p>It was amazing to me when I saw the transform for what it truly was: an actual transformation matrix!
That said, the Discrete Fourier Transform is slow -- primarily because matrix multiplication is slow, and as mentioned before, slow code is not particularly useful.
So what was the trick that everyone used to go from a Discrete Fourier Transform to a <em>Fast</em> Fourier Transform?</p>
<p>Recursion!</p>
<h3 id="the-cooley-tukey-algorithm">The Cooley-Tukey Algorithm</h3>
<p>The problem with using a standard DFT is that it requires a large matrix multiplications and sums over all elements, which are prohibitively complex operations.
The Cooley-Tukey algorithm calculates the DFT directly with fewer summations and without matrix multiplications.
If necessary, DFT&apos;s can still be calculated directly at the early stages of the FFT calculation.
The trick to the Cooley-Tukey algorithm is recursion.
In particular, we split the matrix we wish to perform the FFT on into two parts: one for all elements with even indices and another for all odd indices.
We then proceed to split the array again and again until we have a manageable array size to perform a DFT (or similar FFT) on.
We can also perform a similar re-ordering by using a bit reversal scheme, where we output each array index&apos;s integer value in binary and flip it to find the new location of that element.
With recursion, we can reduce the complexity to <script type="math/tex; ">\sim \mathcal{O}(n \log n)</script>, which is a feasible operation.</p>
<p>In the end, the code looks like:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
        x_odd <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
        x_even <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        x_odd <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        x_even <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    half <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    factor <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vcat<span class="token punctuation">(</span>x_odd <span class="token punctuation">.</span><span class="token operator">+</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">,</span>
                x_odd <span class="token punctuation">.</span><span class="token operator">-</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> <span class="token keyword">const</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> complex tmp <span class="token punctuation">[</span>N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token function">cexp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> I <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span>X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="clj" data-name="Clojure"><pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">defn</span> fft <span class="token punctuation">[</span>vx<span class="token punctuation">]</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>len <span class="token punctuation">(</span><span class="token keyword">count</span> vx<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">=</span> len <span class="token number">1</span><span class="token punctuation">)</span>
      vx
      <span class="token comment">;;else</span>
      <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token comment">;; take values of vx in the even indices</span>
            even-indices <span class="token punctuation">(</span>keep-indexed #<span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span>even? %<span class="token number">1</span><span class="token punctuation">)</span> %<span class="token number">2</span><span class="token punctuation">)</span> vx<span class="token punctuation">)</span>
            <span class="token comment">;; take values in the odd indices</span>
            odd-indices <span class="token punctuation">(</span>keep-indexed #<span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span>odd? %<span class="token number">1</span><span class="token punctuation">)</span> %<span class="token number">2</span><span class="token punctuation">)</span> vx<span class="token punctuation">)</span>
            <span class="token comment">;; recursion</span>
            even-fft <span class="token punctuation">(</span>fft even-indices<span class="token punctuation">)</span>
            odd-fft <span class="token punctuation">(</span>fft odd-indices<span class="token punctuation">)</span>
            <span class="token comment">;; make a sequence of e^(-2pi*i*k/N) where N is the length</span>
            <span class="token comment">;; vx and k range from 0 to N/2</span>
            omegas-half <span class="token punctuation">(</span><span class="token keyword">map</span>
                         <span class="token punctuation">(</span><span class="token keyword">comp</span> <span class="token number">c</span>/exp
                               <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token number">c</span>/<span class="token keyword">*</span>
                                        <span class="token punctuation">(</span><span class="token keyword">/</span> len<span class="token punctuation">)</span>
                                        <span class="token number">2</span> Math/PI
                                        <span class="token punctuation">(</span><span class="token number">c</span>/complex <span class="token number">0</span> -<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                         <span class="token punctuation">(</span><span class="token keyword">range</span> <span class="token number">0</span> <span class="token punctuation">(</span><span class="token keyword">quot</span> len <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">;; take the negative of the first sequence because</span>
            <span class="token comment">;; e^(-2pi*i*(k+N/2)/N=-e^(-2pi*i*k/N) where k ranges from</span>
            <span class="token comment">;; 0 to N/2 </span>
            omegas-2half <span class="token punctuation">(</span><span class="token keyword">map</span> <span class="token number">c</span>/<span class="token keyword">-</span> omegas-half<span class="token punctuation">)</span>
            mult-<span class="token number">add</span> <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token keyword">map</span> #<span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">+</span> %<span class="token number">3</span> <span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">*</span> %<span class="token number">1</span> %<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">(</span><span class="token keyword">concat</span> <span class="token punctuation">(</span>mult-<span class="token number">add</span> omegas-half odd-fft even-fft<span class="token punctuation">)</span>
                <span class="token punctuation">(</span>mult-<span class="token number">add</span> omegas-2half odd-fft even-fft<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>Iter first<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">auto</span> size <span class="token operator">=</span> last <span class="token operator">-</span> first<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// split the range, with even indices going in the first half,</span>
    <span class="token comment">// and odd indices going in the last half.</span>
    <span class="token keyword">auto</span> temp <span class="token operator">=</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span><span class="token punctuation">(</span>size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      first<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      first<span class="token punctuation">[</span>i <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// recurse the splits and butterflies in each half of the range</span>
    <span class="token keyword">auto</span> split <span class="token operator">=</span> first <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> split<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>split<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// now combine each of those halves with the butterflies</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> w <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">auto</span><span class="token operator">&amp;</span> bottom <span class="token operator">=</span> first<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span><span class="token operator">&amp;</span> top <span class="token operator">=</span> first<span class="token punctuation">[</span>k <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      top <span class="token operator">=</span> bottom <span class="token operator">-</span> w <span class="token operator">*</span> top<span class="token punctuation">;</span>
      bottom <span class="token operator">-=</span> top <span class="token operator">-</span> bottom<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">fft</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span>
<span class="token hvariable">fft</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token hvariable">x</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">length</span> <span class="token hvariable">x</span>
    <span class="token hvariable">w0</span> <span class="token operator">=</span> <span class="token builtin">exp</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pi</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">:+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span><span class="token punctuation">)</span>
    <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token hvariable">M.fromList</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span> <span class="token hvariable">n</span><span class="token punctuation">,</span> <span class="token hvariable">w0</span> <span class="token operator">^</span> <span class="token hvariable">k</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token hvariable">fft</span>&apos; <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">]</span>
    <span class="token hvariable">fft</span>&apos; <span class="token hvariable">x</span> <span class="token operator">=</span>
      <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token hvariable">evens</span><span class="token punctuation">,</span> <span class="token hvariable">odds</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">partition</span> <span class="token punctuation">(</span><span class="token builtin">even</span><span class="token operator"> . </span><span class="token builtin">fst</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token builtin">zip</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span> <span class="token hvariable">x</span>
          <span class="token hvariable">e</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token operator">$</span> <span class="token builtin">map</span> <span class="token builtin">snd</span> <span class="token hvariable">evens</span>
          <span class="token hvariable">o</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token operator">$</span> <span class="token builtin">map</span> <span class="token builtin">snd</span> <span class="token hvariable">odds</span>
          <span class="token hvariable">x1</span> <span class="token operator">=</span> <span class="token builtin">zipWith3</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token hvariable">k</span> <span class="token operator">-&gt;</span> <span class="token hvariable">e</span> <span class="token operator">+</span> <span class="token hvariable">o</span> <span class="token operator">*</span> <span class="token hvariable">w</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span><span class="token hvariable">n</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span>
          <span class="token hvariable">x2</span> <span class="token operator">=</span> <span class="token builtin">zipWith3</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token hvariable">k</span> <span class="token operator">-&gt;</span> <span class="token hvariable">e</span> <span class="token operator">-</span> <span class="token hvariable">o</span> <span class="token operator">*</span> <span class="token hvariable">w</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span><span class="token hvariable">n</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span>
       <span class="token keyword">in</span> <span class="token hvariable">x1</span> <span class="token operator">++</span> <span class="token hvariable">x2</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    <span class="token keyword">if</span> N <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> X
    even <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    odd <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    temp <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> even<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> odd<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
        temp<span class="token punctuation">[</span>k <span class="token operator">+</span> N <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> even<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> odd<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    <span class="token keyword">return</span> temp
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
        x_odd <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
        x_even <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        x_odd <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        x_even <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    half <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    factor <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vcat<span class="token punctuation">(</span>x_odd <span class="token punctuation">.</span><span class="token operator">+</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">,</span>
                x_odd <span class="token punctuation">.</span><span class="token operator">-</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">cooley_tukey:</span>
  cmp    <span class="token register variable">rsi</span>, <span class="token number">16</span>                     # Check if size if greater then <span class="token number">1</span>
  jle    cooley_tukey_return
  push   <span class="token register variable">rbx</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>                    # Save parameters
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  mov    <span class="token register variable">r14</span>, <span class="token register variable">rsi</span>                    # Save N <span class="token operator">/</span> <span class="token number">2</span>
  shr    <span class="token register variable">r14</span>, <span class="token number">1</span>
  sub    <span class="token register variable">rsp</span>, <span class="token register variable">r14</span>                    # Make a tmp array
  xor    <span class="token register variable">r15</span>, <span class="token register variable">r15</span>
  mov    <span class="token register variable">rbx</span>, <span class="token register variable">r12</span>
<span class="token label function">cooley_tukey_spliting:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">r14</span>
  je     cooley_tukey_split
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token register variable">r15</span><span class="token operator">]</span>        # Moving all odd entries to the front of the array
  movaps <span class="token register variable">xmm0</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token operator">]</span>
  movaps <span class="token register variable">xmm1</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r15</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  add    <span class="token register variable">rbx</span>, <span class="token number">16</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    cooley_tukey_spliting
<span class="token label function">cooley_tukey_split:</span>
  mov    <span class="token register variable">rax</span>, <span class="token register variable">rsp</span>
  lea    <span class="token register variable">rdi</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r13</span><span class="token operator">]</span>
<span class="token label function">cooley_tukey_mov_data:</span>
  cmp    <span class="token register variable">rbx</span>, <span class="token register variable">rdi</span>
  je     cooley_tukey_moved
  movaps <span class="token register variable">xmm0</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  add    <span class="token register variable">rbx</span>, <span class="token number">16</span>
  add    <span class="token register variable">rax</span>, <span class="token number">16</span>
  jmp    cooley_tukey_mov_data
<span class="token label function">cooley_tukey_moved:</span>
  add    <span class="token register variable">rsp</span>, <span class="token register variable">r14</span>
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">r12</span>                   # Makking a recursive call
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">r14</span>
  call   cooley_tukey
  lea    <span class="token register variable">rdi</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>           # Makking a recursive call
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">r14</span>
  call   cooley_tukey
  lea    <span class="token register variable">rbx</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>
  mov    <span class="token register variable">r14</span>, <span class="token register variable">rbx</span>
  mov    <span class="token register variable">r15</span>, <span class="token register variable">r12</span>
<span class="token label function">cooley_tukey_loop:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">rbx</span>
  je     cooley_tukey_end
  pxor   <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                 # Calculate cexp(<span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> I <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">/</span> N)
  movsd  <span class="token register variable">xmm1</span>, two_pi
  mov    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>
  sub    <span class="token register variable">rax</span>, <span class="token register variable">rbx</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">rax</span>
  cvtsi2sdq <span class="token register variable">xmm3</span>, <span class="token register variable">r13</span>
  divsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm3</span>
  mulsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  call   cexp
  movq   <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span><span class="token operator">]</span>      # Calculating X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">-</span> cexp() <span class="token operator">*</span> X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span>
  movq   <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   __muldc3
  movq   <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>
  movq   <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span><span class="token operator">]</span>, <span class="token register variable">xmm2</span>      # Save value in X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm3</span>
  movq   <span class="token register variable">xmm0</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>      # Calculating X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">-</span><span class="token operator">=</span> X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span> <span class="token operator">-</span> X<span class="token operator">[</span>i<span class="token operator">]</span>
  movq   <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm2</span>
  subsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  add    <span class="token register variable">r14</span>, <span class="token number">16</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    cooley_tukey_loop
<span class="token label function">cooley_tukey_end:</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  pop    <span class="token register variable">rbx</span>
<span class="token label function">cooley_tukey_return:</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> half <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token constant">N</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">N</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Extract even and odd indexed elements with remainder mod 2</span>
  <span class="token keyword">const</span> evens <span class="token operator">=</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token punctuation">(</span>idx <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> odds <span class="token operator">=</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> idx <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Fill an array with null values</span>
  <span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> half<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arg <span class="token operator">=</span> odds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> evens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    temp<span class="token punctuation">[</span>i <span class="token operator">+</span> half<span class="token punctuation">]</span> <span class="token operator">=</span> evens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div></div></div>

<p>As a side note, we are enforcing that the array must be a power of 2 for the operation to work.
This is a limitation of the fact that we are using recursion and dividing the array in 2 every time; however, if your array is not a power of 2, you can simply pad the leftover space with 0&apos;s until your array is a power of 2.</p>
<p>The above method is a perfectly valid FFT; however, it is missing the pictorial heart and soul of the Cooley-Tukey algorithm: Butterfly Diagrams.</p>
<h3 id="butterfly-diagrams">Butterfly Diagrams</h3>
<p>Butterfly Diagrams show where each element in the array goes before, during, and after the FFT.
As mentioned, the FFT must perform a DFT.
This means that even though we need to be careful about how we add elements together, we are still ultimately performing the following operation:</p>
<p><script type="math/tex; ">X_k = \sum_{n=0}^{N-1} x_n \cdot e^{-2 \pi i k n / N}</script></p>
<p>However, after shuffling the initial array (by bit reversing or recursive subdivision), we perform the matrix multiplication of the <script type="math/tex; ">e^{-2 \pi k n / N}</script> terms in pieces.
Basically, we split the array into a series of omega values:</p>
<p><script type="math/tex; ">\omega_N^k = e^{-2 \pi i k / N}</script></p>
<p>And at each step, we use the appropriate term.
For example, imagine we need to perform an FFT of an array of only 2 elements.
We can represent this addition with the following (radix-2) butterfly:</p>
<p>
    <img class="center" src="res/radix-2screen_positive.jpg" width="400">
</p>

<p>Here, the diagram means the following:</p>
<p><script type="math/tex; mode=display">
b_0 = a_0 + \omega_2^0 a_1 \\

b_1 = a_0 + \omega_2^1 a_1
</script></p>
<p>However, it turns out that the second half of our array of <script type="math/tex; ">\omega</script> values is always the negative of the first half, so <script type="math/tex; ">\omega_2^0 = -\omega_2^1</script>, so we can use the following butterfly diagram:</p>
<p>
    <img class="center" src="res/radix-2screen.jpg" width="400">
</p>

<p>With the following equations:</p>
<p><script type="math/tex; mode=display">
b_0 = a_0 + \omega_2^0 a_1 \\

b_1 = a_0 - \omega_2^0 a_1
</script></p>
<p>By swapping out the second <script type="math/tex; ">\omega</script> value in this way, we can save a good amount of space.
Now imagine we need to combine more elements.
In this case, we start with simple butterflies, as shown above, and then sum butterflies of butterflies.
For example, if we have 8 elements, this might look like this:</p>
<p>
    <img class="center" src="res/radix-8screen.jpg" width="500">
</p>

<p>Note that we can perform a DFT directly before using any butterflies, if we so desire, but we need to be careful with how we shuffle our array if that&apos;s the case.
In the code snippet provided in the previous section, the subdivision was performed in the same function as the concatenation, so the ordering was always correct; however, if we were to re-order with bit-reversal, this might not be the case.</p>
<p>For example, take a look at the ordering of FFT (<a href="https://en.wikipedia.org/wiki/Butterfly_diagram" target="_blank">found on wikipedia</a>) that performs the DFT shortcut:</p>
<p>
    <img class="center" src="res/butterfly_diagram.png" width="600">
</p>

<p>Here, the ordering of the array was simply divided into even and odd elements once, but they did not recursively divide the arrays of even and odd elements again because they knew they would perform a DFT soon thereafter.</p>
<p>Ultimately, that&apos;s all I want to say about Fourier Transforms for now, but this chapter still needs a good amount of work!
I&apos;ll definitely come back to this at some point, so let me know what you liked and didn&apos;t like and we can go from there!</p>
<h3 id="bibliography">Bibliography</h3>
<p><table class="references"><tr><td><span class="citation-number" id="cite-1">1</span></td><td>Cooley, James W and Tukey, John W, An algorithm for the machine calculation of complex Fourier series, <i>JSTOR</i>, 1965.</td></tr></table></p>
<h2 id="example-code">Example Code</h2>
<p>To be clear, the example code this time will be complicated and requires the following functions:</p>
<ul>
<li>An FFT library (either in-built or something like FFTW)</li>
<li>An approximation function to tell if two arrays are similar</li>
</ul>
<p>As mentioned in the text, the Cooley-Tukey algorithm may be implemented either recursively or non-recursively, with the recursive method being much easier to implement.
I would ask that you implement either the recursive or non-recursive methods (or both, if you feel so inclined).
If the language you want to write your implementation in is already used, please append your code to the already existing codebase.
As before, pull requests are favoured.</p>
<p>Note: I implemented this in Julia because the code seems more straightforward in Julia; however, if you wish to write better Julia code or better code in your own language, please feel free to do so!
<strong>I do not claim that this is the most efficient way to implement the Cooley-Tukey method, so if you have a better way to do it, feel free to implement it that way!</strong></p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">using</span> FFTW

<span class="token comment">#simple DFT function</span>
<span class="token keyword">function</span> DFT<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token comment"># We want two vectors here for real space (n) and frequency space (k)</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    k <span class="token operator">=</span> n&apos;
    transform_matrix <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">*</span>k<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> transform_matrix<span class="token operator">*</span>x

<span class="token keyword">end</span>

<span class="token comment"># Implementing the Cooley-Tukey Algorithm</span>
<span class="token keyword">function</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
        x_odd <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
        x_even <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        x_odd <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        x_even <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>
    n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span>
    half <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    factor <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">/</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vcat<span class="token punctuation">(</span>x_odd <span class="token punctuation">.</span><span class="token operator">+</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">,</span>
                x_odd <span class="token punctuation">.</span><span class="token operator">-</span> x_even <span class="token punctuation">.</span><span class="token operator">*</span> factor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>half<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">end</span>

<span class="token keyword">function</span> bitreverse<span class="token punctuation">(</span>a<span class="token punctuation">:</span><span class="token punctuation">:</span>Array<span class="token punctuation">)</span>
    <span class="token comment"># First, we need to find the necessary number of bits</span>
    digits <span class="token operator">=</span> convert<span class="token punctuation">(</span>Int<span class="token punctuation">,</span>ceil<span class="token punctuation">(</span>log2<span class="token punctuation">(</span>length<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    indices <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

    bit_indices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>indices<span class="token punctuation">)</span>
        push<span class="token operator">!</span><span class="token punctuation">(</span>bit_indices<span class="token punctuation">,</span> bitstring<span class="token punctuation">(</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    <span class="token comment"># Now stripping the unnecessary numbers</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>bit_indices<span class="token punctuation">)</span>
        bit_indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bit_indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">end</span><span class="token operator">-</span>digits<span class="token punctuation">:</span><span class="token keyword">end</span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>

    <span class="token comment"># Flipping the bits</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>bit_indices<span class="token punctuation">)</span>
        bit_indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> reverse<span class="token punctuation">(</span>bit_indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    <span class="token comment"># Replacing indices</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>indices<span class="token punctuation">)</span>
        indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>digits
            indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> parse<span class="token punctuation">(</span>Int<span class="token punctuation">,</span> string<span class="token punctuation">(</span>bit_indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">end</span><span class="token operator">-</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
       indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">end</span>

    b <span class="token operator">=</span> <span class="token punctuation">[</span>float<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>indices<span class="token punctuation">)</span>
        b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>indices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> b
<span class="token keyword">end</span>

<span class="token keyword">function</span> iterative_cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    logN <span class="token operator">=</span> convert<span class="token punctuation">(</span>Int<span class="token punctuation">,</span>ceil<span class="token punctuation">(</span>log2<span class="token punctuation">(</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    bnum <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    stride <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    x <span class="token operator">=</span> bitreverse<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    z <span class="token operator">=</span> <span class="token punctuation">[</span>Complex<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>logN
       stride <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span> bnum<span class="token punctuation">)</span>
       <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>bnum<span class="token operator">-</span><span class="token number">1</span>
           start_index <span class="token operator">=</span> j<span class="token operator">*</span>stride <span class="token operator">+</span> <span class="token number">1</span>
           y <span class="token operator">=</span> butterfly<span class="token punctuation">(</span>z<span class="token punctuation">[</span>start_index<span class="token punctuation">:</span>start_index <span class="token operator">+</span> stride <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
           <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
               z<span class="token punctuation">[</span>start_index<span class="token operator">+</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
           <span class="token keyword">end</span>
       <span class="token keyword">end</span>
       bnum <span class="token operator">=</span> div<span class="token punctuation">(</span>bnum<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> z
<span class="token keyword">end</span>

<span class="token keyword">function</span> butterfly<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    N <span class="token operator">=</span> length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    half <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    half <span class="token operator">=</span> div<span class="token punctuation">(</span>N<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    factor <span class="token operator">=</span> exp<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span>im<span class="token operator">*</span>pi<span class="token operator">*</span>n<span class="token operator">/</span>N<span class="token punctuation">)</span>

    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">0.0</span>im <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>half
        y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> x<span class="token punctuation">[</span>half<span class="token operator">+</span>i<span class="token punctuation">]</span><span class="token operator">*</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        y<span class="token punctuation">[</span>half<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> x<span class="token punctuation">[</span>half<span class="token operator">+</span>i<span class="token punctuation">]</span><span class="token operator">*</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> y
<span class="token keyword">end</span>

<span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    z <span class="token operator">=</span> iterative_cooley_tukey<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    w <span class="token operator">=</span> fft<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isapprox<span class="token punctuation">(</span>y<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;Recursive Cooley Tukey matches fft() from FFTW package.&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isapprox<span class="token punctuation">(</span>z<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">&quot;Iterative Cooley Tukey matches fft() from FFTW package.&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;complex.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fftw3.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">fft</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> complex y<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fftw_plan p<span class="token punctuation">;</span>

    p <span class="token operator">=</span> <span class="token function">fftw_plan_dft_1d</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>fftw_complex<span class="token operator">*</span><span class="token punctuation">)</span>x<span class="token punctuation">,</span> <span class="token punctuation">(</span>fftw_complex<span class="token operator">*</span><span class="token punctuation">)</span>y<span class="token punctuation">,</span>
                         FFTW_FORWARD<span class="token punctuation">,</span> FFTW_ESTIMATE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fftw_execute</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fftw_destroy_plan</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">dft</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> <span class="token keyword">const</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> complex tmp<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">cexp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> M_PI <span class="token operator">*</span> I <span class="token operator">*</span> j <span class="token operator">*</span> i <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">memcpy</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> tmp<span class="token punctuation">,</span> N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> <span class="token keyword">const</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> complex tmp <span class="token punctuation">[</span>N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token function">cexp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> I <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span>X<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">bit_reverse</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">int</span> a <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">log2</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>N<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

        n <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            a <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">--</span><span class="token punctuation">;</span>
            n <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> count<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">log2</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> complex tmp <span class="token operator">=</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
            X<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">bit_reverse</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token function">log2</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> stride <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> complex w <span class="token operator">=</span> <span class="token function">cexp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> I <span class="token operator">*</span> M_PI <span class="token operator">/</span> stride<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j <span class="token operator">+=</span> stride<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> complex v <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-</span> v <span class="token operator">*</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span>X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                v <span class="token operator">*=</span> w<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">approx</span><span class="token punctuation">(</span><span class="token keyword">double</span> complex <span class="token operator">*</span>X<span class="token punctuation">,</span> <span class="token keyword">double</span> complex <span class="token operator">*</span>Y<span class="token punctuation">,</span> size_t N<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">cabs</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">cabs</span><span class="token punctuation">(</span>Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1E-5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;This is not approximate.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;This is approximate.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> complex x<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> z<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> RAND_MAX<span class="token punctuation">;</span>
        y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">approx</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">approx</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> z<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="clj" data-name="Clojure"><pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">ns</span> fft.core
  <span class="token punctuation">(</span><span class="token operator">:require</span> <span class="token punctuation">[</span>complex.core <span class="token operator">:as</span> <span class="token number">c</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">;; complex is a jar for complex numbers</span>
<span class="token comment">;; https://github.com/alanforr/complex</span>
<span class="token comment">;; add [complex &quot;0.1.11&quot;] to :dependencies in your project.clj</span>
<span class="token comment">;; and run lein repl or lein deps in the terminal</span>
<span class="token punctuation">(</span><span class="token keyword">defn</span> matrix-mult
  <span class="token string">&quot;take a matrix m and a vector v which length is number of columns
  ,return a vector of applying dot-product between v and each row of
  m. the returned vector&apos;s length is the number of rows of m&quot;</span>
  <span class="token punctuation">[</span>m v<span class="token punctuation">]</span>
  <span class="token punctuation">(</span>mapv <span class="token punctuation">(</span><span class="token keyword">comp</span> <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token keyword">apply</span> <span class="token number">c</span>/<span class="token keyword">+</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token keyword">map</span> <span class="token number">c</span>/<span class="token keyword">*</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span>
        m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">defn</span> dft
  <span class="token string">&quot;take a vector of real numbers and return a vector of frequency
  space&quot;</span>
  <span class="token punctuation">[</span>vx<span class="token punctuation">]</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>len <span class="token punctuation">(</span><span class="token keyword">count</span> vx<span class="token punctuation">)</span><span class="token punctuation">]</span>
     <span class="token punctuation">(</span>matrix-mult
      <span class="token punctuation">(</span>partition len
                 <span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token punctuation">[</span>n <span class="token punctuation">(</span><span class="token keyword">range</span> len<span class="token punctuation">)</span>
                       k <span class="token punctuation">(</span><span class="token keyword">range</span> len<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token comment">;; expresion below is</span>
                   <span class="token comment">;; e^(n*k*2*pi*(1/len)*(-i))</span>
                   <span class="token punctuation">(</span><span class="token number">c</span>/exp <span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">*</span> n k
                               <span class="token number">2</span> Math/PI
                               <span class="token punctuation">(</span><span class="token keyword">/</span> len<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token number">c</span>/complex <span class="token number">0</span> -<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      vx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">defn</span> fft <span class="token punctuation">[</span>vx<span class="token punctuation">]</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>len <span class="token punctuation">(</span><span class="token keyword">count</span> vx<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">=</span> len <span class="token number">1</span><span class="token punctuation">)</span>
      vx
      <span class="token comment">;;else</span>
      <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token comment">;; take values of vx in the even indices</span>
            even-indices <span class="token punctuation">(</span>keep-indexed #<span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span>even? %<span class="token number">1</span><span class="token punctuation">)</span> %<span class="token number">2</span><span class="token punctuation">)</span> vx<span class="token punctuation">)</span>
            <span class="token comment">;; take values in the odd indices</span>
            odd-indices <span class="token punctuation">(</span>keep-indexed #<span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span>odd? %<span class="token number">1</span><span class="token punctuation">)</span> %<span class="token number">2</span><span class="token punctuation">)</span> vx<span class="token punctuation">)</span>
            <span class="token comment">;; recursion</span>
            even-fft <span class="token punctuation">(</span>fft even-indices<span class="token punctuation">)</span>
            odd-fft <span class="token punctuation">(</span>fft odd-indices<span class="token punctuation">)</span>
            <span class="token comment">;; make a sequence of e^(-2pi*i*k/N) where N is the length</span>
            <span class="token comment">;; vx and k range from 0 to N/2</span>
            omegas-half <span class="token punctuation">(</span><span class="token keyword">map</span>
                         <span class="token punctuation">(</span><span class="token keyword">comp</span> <span class="token number">c</span>/exp
                               <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token number">c</span>/<span class="token keyword">*</span>
                                        <span class="token punctuation">(</span><span class="token keyword">/</span> len<span class="token punctuation">)</span>
                                        <span class="token number">2</span> Math/PI
                                        <span class="token punctuation">(</span><span class="token number">c</span>/complex <span class="token number">0</span> -<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                         <span class="token punctuation">(</span><span class="token keyword">range</span> <span class="token number">0</span> <span class="token punctuation">(</span><span class="token keyword">quot</span> len <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">;; take the negative of the first sequence because</span>
            <span class="token comment">;; e^(-2pi*i*(k+N/2)/N=-e^(-2pi*i*k/N) where k ranges from</span>
            <span class="token comment">;; 0 to N/2 </span>
            omegas-2half <span class="token punctuation">(</span><span class="token keyword">map</span> <span class="token number">c</span>/<span class="token keyword">-</span> omegas-half<span class="token punctuation">)</span>
            mult-<span class="token number">add</span> <span class="token punctuation">(</span><span class="token keyword">partial</span> <span class="token keyword">map</span> #<span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">+</span> %<span class="token number">3</span> <span class="token punctuation">(</span><span class="token number">c</span>/<span class="token keyword">*</span> %<span class="token number">1</span> %<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">(</span><span class="token keyword">concat</span> <span class="token punctuation">(</span>mult-<span class="token number">add</span> omegas-half odd-fft even-fft<span class="token punctuation">)</span>
                <span class="token punctuation">(</span>mult-<span class="token number">add</span> omegas-2half odd-fft even-fft<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">defn</span> -main <span class="token punctuation">[</span>&amp; args<span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>vx <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span><span class="token punctuation">]</span>
          len <span class="token punctuation">(</span><span class="token keyword">count</span> vx<span class="token punctuation">)</span>
          <span class="token comment">;; calculate the next power of 2 after len</span>
          <span class="token comment">;; the reason behind this is to fill them with zeros for fft</span>
          next-len <span class="token punctuation">(</span><span class="token keyword">-&gt;&gt;</span>
                    <span class="token punctuation">[</span>len <span class="token number">2</span><span class="token punctuation">]</span>
                    <span class="token punctuation">(</span><span class="token keyword">map</span> #<span class="token punctuation">(</span>Math/log %<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token keyword">apply</span> <span class="token keyword">/</span><span class="token punctuation">)</span>
                    Math/ceil
                    <span class="token punctuation">(</span>Math/pow <span class="token number">2</span><span class="token punctuation">)</span>
                    <span class="token keyword">int</span><span class="token punctuation">)</span>
          <span class="token comment">;; add zeros at the end of vx</span>
          complete-vx <span class="token punctuation">(</span><span class="token keyword">into</span> vx <span class="token punctuation">(</span><span class="token keyword">repeat</span> <span class="token punctuation">(</span><span class="token keyword">-</span> next-len len<span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          fft-cvx <span class="token punctuation">(</span>fft complete-vx<span class="token punctuation">)</span>
          dft-cvx <span class="token punctuation">(</span>dft complete-vx<span class="token punctuation">)</span>
          diffv <span class="token punctuation">(</span>mapv <span class="token number">c</span>/<span class="token keyword">-</span> fft-cvx dft-cvx<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token keyword">println</span> <span class="token string">&quot;vx:&quot;</span> vx<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">println</span> <span class="token string">&quot;complete-vx:&quot;</span> complete-vx<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">println</span> <span class="token string">&quot;result from fft:&quot;</span> <span class="token punctuation">(</span><span class="token keyword">map</span> <span class="token number">c</span>/stringify fft-cvx<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">println</span> <span class="token string">&quot;result from dft:&quot;</span> <span class="token punctuation">(</span><span class="token keyword">map</span> <span class="token number">c</span>/stringify dft-cvx<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">println</span> <span class="token string">&quot;difference: &quot;</span> <span class="token punctuation">(</span><span class="token keyword">map</span> <span class="token number">c</span>/stringify diffv<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token comment">// written by Gathros, modernized by Nicole Mazzuca.</span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;array&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;complex&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;cstdint&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token comment">// These headers are for presentation not for the algorithm.</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iomanip&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;random&gt;</span></span>

<span class="token keyword">using</span> std<span class="token operator">::</span>begin<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>end<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span>

<span class="token keyword">using</span> std<span class="token operator">::</span>size_t<span class="token punctuation">;</span>

<span class="token keyword">using</span> complex <span class="token operator">=</span> std<span class="token operator">::</span>complex<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">double</span> pi <span class="token operator">=</span> <span class="token number">3.14159265358979323846264338327950288419716</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">dft</span><span class="token punctuation">(</span>Iter X<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">auto</span> N <span class="token operator">=</span> last <span class="token operator">-</span> X<span class="token punctuation">;</span>
  std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span> <span class="token function">tmp</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  std<span class="token operator">::</span><span class="token function">copy</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">begin</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">end</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// `cooley_tukey` does the cooley-tukey algorithm, recursively</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>Iter first<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">auto</span> size <span class="token operator">=</span> last <span class="token operator">-</span> first<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// split the range, with even indices going in the first half,</span>
    <span class="token comment">// and odd indices going in the last half.</span>
    <span class="token keyword">auto</span> temp <span class="token operator">=</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span><span class="token punctuation">(</span>size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      first<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      first<span class="token punctuation">[</span>i <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// recurse the splits and butterflies in each half of the range</span>
    <span class="token keyword">auto</span> split <span class="token operator">=</span> first <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> split<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>split<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// now combine each of those halves with the butterflies</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> w <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">auto</span><span class="token operator">&amp;</span> bottom <span class="token operator">=</span> first<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">auto</span><span class="token operator">&amp;</span> top <span class="token operator">=</span> first<span class="token punctuation">[</span>k <span class="token operator">+</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      top <span class="token operator">=</span> bottom <span class="token operator">-</span> w <span class="token operator">*</span> top<span class="token punctuation">;</span>
      bottom <span class="token operator">-=</span> top <span class="token operator">-</span> bottom<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// note: (last - first) must be less than 2**32 - 1</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">sort_by_bit_reverse</span><span class="token punctuation">(</span>Iter first<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// sorts the range [first, last) in bit-reversed order,</span>
  <span class="token comment">// by the method suggested by the FFT</span>
  <span class="token keyword">auto</span> size <span class="token operator">=</span> last <span class="token operator">-</span> first<span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token keyword">uint32_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">auto</span> b <span class="token operator">=</span> i<span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xaaaaaaaa</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0x55555555</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xcccccccc</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0x33333333</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xf0f0f0f0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> std<span class="token operator">::</span><span class="token keyword">uint32_t</span><span class="token punctuation">(</span><span class="token function">log2</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">&gt;</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">swap</span><span class="token punctuation">(</span>first<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> first<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// `iterative_cooley_tukey` does the cooley-tukey algorithm iteratively</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> Iter<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span>Iter first<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">sort_by_bit_reverse</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// perform the butterfly on the range</span>
  <span class="token keyword">auto</span> size <span class="token operator">=</span> last <span class="token operator">-</span> first<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> stride <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> stride <span class="token operator">&lt;=</span> size<span class="token punctuation">;</span> stride <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">auto</span> w <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> pi <span class="token operator">/</span> stride<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> j <span class="token operator">+=</span> stride<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> v <span class="token operator">=</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        first<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span>
            first<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-</span> v <span class="token operator">*</span> first<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        first<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token punctuation">(</span>first<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> first<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        v <span class="token operator">*=</span> w<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// initalize the FFT inputs</span>
  std<span class="token operator">::</span>random_device random_device<span class="token punctuation">;</span>
  std<span class="token operator">::</span>mt19937 <span class="token function">rng</span><span class="token punctuation">(</span><span class="token function">random_device</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>uniform_real_distribution<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">distribution</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  std<span class="token operator">::</span>array<span class="token operator">&lt;</span>complex<span class="token punctuation">,</span> <span class="token number">64</span><span class="token operator">&gt;</span> initial<span class="token punctuation">;</span>
  std<span class="token operator">::</span><span class="token function">generate</span><span class="token punctuation">(</span>
      <span class="token function">begin</span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">distribution</span><span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">auto</span> recursive <span class="token operator">=</span> initial<span class="token punctuation">;</span>
  <span class="token keyword">auto</span> iterative <span class="token operator">=</span> initial<span class="token punctuation">;</span>

  <span class="token comment">// Preform an FFT on the arrays.</span>
  <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>recursive<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>recursive<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>iterative<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>iterative<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Check if the arrays are approximately equivalent</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>right <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;idx&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;rec&quot;</span>
            <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;it&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;subtracted&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&apos;\n&apos;</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> initial<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">auto</span> rec <span class="token operator">=</span> recursive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> it <span class="token operator">=</span> iterative<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">abs</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span>
              <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">abs</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
              <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">abs</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span> <span class="token operator">-</span> std<span class="token operator">::</span><span class="token function">abs</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&apos;\n&apos;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token import_statement"><span class="token keyword">import</span> Data.Complex</span>
<span class="token import_statement"><span class="token keyword">import</span> Data.List</span> <span class="token punctuation">(</span><span class="token hvariable">partition</span><span class="token punctuation">)</span>
<span class="token import_statement"><span class="token keyword">import</span> Data.Map</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token import_statement"><span class="token keyword">import</span> <span class="token keyword">qualified</span> Data.Map <span class="token keyword">as</span> M</span>
<span class="token import_statement"><span class="token keyword">import</span> Data.Ratio</span>

<span class="token hvariable">dft</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span>
<span class="token hvariable">dft</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">matMult</span> <span class="token hvariable">dftMat</span> <span class="token hvariable">x</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">length</span> <span class="token hvariable">x</span>
    <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token builtin">exp</span> <span class="token operator">$</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pi</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">:+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span>
    <span class="token hvariable">dftMat</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token hvariable">w</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token hvariable">j</span> <span class="token operator">*</span> <span class="token hvariable">k</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">j</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token hvariable">matMult</span> <span class="token hvariable">m</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator"> . </span><span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>

<span class="token hvariable">fft</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Complex</span> <span class="token constant">Double</span><span class="token punctuation">]</span>
<span class="token hvariable">fft</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token hvariable">x</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">length</span> <span class="token hvariable">x</span>
    <span class="token hvariable">w0</span> <span class="token operator">=</span> <span class="token builtin">exp</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pi</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">:+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span><span class="token punctuation">)</span>
    <span class="token hvariable">w</span> <span class="token operator">=</span> <span class="token hvariable">M.fromList</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span> <span class="token hvariable">n</span><span class="token punctuation">,</span> <span class="token hvariable">w0</span> <span class="token operator">^</span> <span class="token hvariable">k</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token hvariable">fft</span>&apos; <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token punctuation">]</span>
    <span class="token hvariable">fft</span>&apos; <span class="token hvariable">x</span> <span class="token operator">=</span>
      <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token hvariable">evens</span><span class="token punctuation">,</span> <span class="token hvariable">odds</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">partition</span> <span class="token punctuation">(</span><span class="token builtin">even</span><span class="token operator"> . </span><span class="token builtin">fst</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token builtin">zip</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span> <span class="token hvariable">x</span>
          <span class="token hvariable">e</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token operator">$</span> <span class="token builtin">map</span> <span class="token builtin">snd</span> <span class="token hvariable">evens</span>
          <span class="token hvariable">o</span> <span class="token operator">=</span> <span class="token hvariable">fft</span>&apos; <span class="token operator">$</span> <span class="token builtin">map</span> <span class="token builtin">snd</span> <span class="token hvariable">odds</span>
          <span class="token hvariable">x1</span> <span class="token operator">=</span> <span class="token builtin">zipWith3</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token hvariable">k</span> <span class="token operator">-&gt;</span> <span class="token hvariable">e</span> <span class="token operator">+</span> <span class="token hvariable">o</span> <span class="token operator">*</span> <span class="token hvariable">w</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span><span class="token hvariable">n</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span>
          <span class="token hvariable">x2</span> <span class="token operator">=</span> <span class="token builtin">zipWith3</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token hvariable">k</span> <span class="token operator">-&gt;</span> <span class="token hvariable">e</span> <span class="token operator">-</span> <span class="token hvariable">o</span> <span class="token operator">*</span> <span class="token hvariable">w</span> <span class="token operator">!</span> <span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">%</span><span class="token hvariable">n</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">e</span> <span class="token hvariable">o</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">]</span>
       <span class="token keyword">in</span> <span class="token hvariable">x1</span> <span class="token operator">++</span> <span class="token hvariable">x2</span>

<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token builtin">print</span> <span class="token operator">$</span> <span class="token hvariable">dft</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
  <span class="token builtin">print</span> <span class="token operator">$</span> <span class="token hvariable">fft</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
</code></pre>
</div><div class="code-method-sample" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> random
<span class="token keyword">from</span> cmath <span class="token keyword">import</span> exp<span class="token punctuation">,</span> pi
<span class="token keyword">from</span> math <span class="token keyword">import</span> log2


<span class="token keyword">def</span> <span class="token function">dft</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> N
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
            temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> X<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> i <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> temp


<span class="token keyword">def</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    <span class="token keyword">if</span> N <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> X
    even <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    odd <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    temp <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> even<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> odd<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
        temp<span class="token punctuation">[</span>k <span class="token operator">+</span> N <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> even<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">*</span> k <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> odd<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    <span class="token keyword">return</span> temp


<span class="token keyword">def</span> <span class="token function">bit_reverse</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        b <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token builtin">int</span><span class="token punctuation">(</span>log2<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span>
                i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>log2<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> k <span class="token operator">&gt;&gt;</span> i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>b<span class="token punctuation">]</span>
        temp<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    <span class="token keyword">return</span> temp


<span class="token keyword">def</span> <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    X <span class="token operator">=</span> bit_reverse<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>log2<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        stride <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> i
        w <span class="token operator">=</span> exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0j</span> <span class="token operator">*</span> pi <span class="token operator">/</span> stride<span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> N<span class="token punctuation">,</span> stride<span class="token punctuation">)</span><span class="token punctuation">:</span>
            v <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>stride <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-</span> v <span class="token operator">*</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span>
                X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">-=</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> X<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span>
                v <span class="token operator">*=</span> w
    <span class="token keyword">return</span> X


X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

Y <span class="token operator">=</span> cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
Z <span class="token operator">=</span> iterative_cooley_tukey<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
T <span class="token operator">=</span> dft<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> Z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> T<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample" data-lang="scratch" data-name="Scratch"><p>Some rather impressive scratch code was submitted by Jie and can be found here: <a href="https://scratch.mit.edu/projects/37759604/#editor" target="_blank">https://scratch.mit.edu/projects/37759604/#editor</a></p>
</div><div class="code-method-sample" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64">.intel_syntax noprefix

.section .rodata
  <span class="token label function">two:</span>           .double <span class="token number">2.0</span>
  <span class="token label function">one:</span>           .double <span class="token number">1.0</span>
  <span class="token label function">two_pi:</span>        .double <span class="token operator">-</span><span class="token number">6.28318530718</span>
  <span class="token label function">rand_max:</span>      .long <span class="token number">4290772992</span>
                 .long <span class="token number">1105199103</span>
  <span class="token label function">fmt:</span>           .string <span class="token string">&quot;%g\n&quot;</span>

.section .text
  .<span class="token keyword">global main</span>
  .<span class="token keyword">extern printf, memset, memcpy, srand, rand, time, cexp, __muldc3, cabs, log2</span>

# <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">dft:</span>
  push   <span class="token register variable">rbx</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>                    # Save parameters
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  sub    <span class="token register variable">rsp</span>, <span class="token register variable">r13</span>                    # Make a double complex array
  xor    <span class="token register variable">r14</span>, <span class="token register variable">r14</span>                    # Set index to <span class="token number">0</span>
<span class="token label function">dft_loop_i:</span>
  cmp    <span class="token register variable">r14</span>, <span class="token register variable">r13</span>                    # Check if index is equal to array size
  je     dft_end_i
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>            # Set tmp array to zero at <span class="token register variable">r14</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token number">0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token number">0</span>
  xor    <span class="token register variable">r15</span>, <span class="token register variable">r15</span>                    # Set second index to <span class="token number">0</span>
<span class="token label function">dft_loop_j:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">r13</span>                    # Check if the index is equal to array size
  je     dft_end_j
  movsd  <span class="token register variable">xmm1</span>, two_pi                # Calculate <span class="token register variable">xmm1</span> <span class="token operator">=</span> <span class="token operator">-</span>2pi <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N
  mov    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>
  imul   <span class="token register variable">rax</span>, <span class="token register variable">r15</span>
  shr    <span class="token register variable">rax</span>, <span class="token number">4</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">rax</span>
  mulsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">r13</span>
  divsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  pxor   <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Set <span class="token register variable">xmm0</span> to <span class="token number">0</span>
  call   cexp
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r15</span><span class="token operator">]</span>            # Calculate X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">*</span> cexp(<span class="token operator">-</span>2pi <span class="token operator">*</span> i <span class="token operator">*</span> j <span class="token operator">/</span> N)
  movsd  <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   __muldc3
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm6</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>       # Sum to tmp array
  movsd  <span class="token register variable">xmm7</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm0</span>
  addsd  <span class="token register variable">xmm7</span>, <span class="token register variable">xmm1</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token register variable">xmm6</span>       # Save to tmp array
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm7</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    dft_loop_j
<span class="token label function">dft_end_j:</span>
  add    <span class="token register variable">r14</span>, <span class="token number">16</span>
  jmp    dft_loop_i
<span class="token label function">dft_end_i:</span>
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">r12</span>                    # Move tmp array to array ptr
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">rsp</span>
  mov    <span class="token register variable">rdx</span>, <span class="token register variable">r13</span>
  call   memcpy
  add    <span class="token register variable">rsp</span>, <span class="token register variable">r13</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  pop    <span class="token register variable">rbx</span>
  ret

# <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">cooley_tukey:</span>
  cmp    <span class="token register variable">rsi</span>, <span class="token number">16</span>                     # Check if size if greater then <span class="token number">1</span>
  jle    cooley_tukey_return
  push   <span class="token register variable">rbx</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>                    # Save parameters
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  mov    <span class="token register variable">r14</span>, <span class="token register variable">rsi</span>                    # Save N <span class="token operator">/</span> <span class="token number">2</span>
  shr    <span class="token register variable">r14</span>, <span class="token number">1</span>
  sub    <span class="token register variable">rsp</span>, <span class="token register variable">r14</span>                    # Make a tmp array
  xor    <span class="token register variable">r15</span>, <span class="token register variable">r15</span>
  mov    <span class="token register variable">rbx</span>, <span class="token register variable">r12</span>
<span class="token label function">cooley_tukey_spliting:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">r14</span>
  je     cooley_tukey_split
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token register variable">r15</span><span class="token operator">]</span>        # Moving all odd entries to the front of the array
  movaps <span class="token register variable">xmm0</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token operator">]</span>
  movaps <span class="token register variable">xmm1</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token register variable">r15</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  add    <span class="token register variable">rbx</span>, <span class="token number">16</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    cooley_tukey_spliting
<span class="token label function">cooley_tukey_split:</span>
  mov    <span class="token register variable">rax</span>, <span class="token register variable">rsp</span>
  lea    <span class="token register variable">rdi</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r13</span><span class="token operator">]</span>
<span class="token label function">cooley_tukey_mov_data:</span>
  cmp    <span class="token register variable">rbx</span>, <span class="token register variable">rdi</span>
  je     cooley_tukey_moved
  movaps <span class="token register variable">xmm0</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  add    <span class="token register variable">rbx</span>, <span class="token number">16</span>
  add    <span class="token register variable">rax</span>, <span class="token number">16</span>
  jmp    cooley_tukey_mov_data
<span class="token label function">cooley_tukey_moved:</span>
  add    <span class="token register variable">rsp</span>, <span class="token register variable">r14</span>
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">r12</span>                   # Makking a recursive call
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">r14</span>
  call   cooley_tukey
  lea    <span class="token register variable">rdi</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>           # Makking a recursive call
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">r14</span>
  call   cooley_tukey
  lea    <span class="token register variable">rbx</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>
  mov    <span class="token register variable">r14</span>, <span class="token register variable">rbx</span>
  mov    <span class="token register variable">r15</span>, <span class="token register variable">r12</span>
<span class="token label function">cooley_tukey_loop:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">rbx</span>
  je     cooley_tukey_end
  pxor   <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                 # Calculate cexp(<span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> I <span class="token operator">*</span> M_PI <span class="token operator">*</span> i <span class="token operator">/</span> N)
  movsd  <span class="token register variable">xmm1</span>, two_pi
  mov    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>
  sub    <span class="token register variable">rax</span>, <span class="token register variable">rbx</span>
  cvtsi2sdq <span class="token register variable">xmm2</span>, <span class="token register variable">rax</span>
  cvtsi2sdq <span class="token register variable">xmm3</span>, <span class="token register variable">r13</span>
  divsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm3</span>
  mulsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm2</span>
  call   cexp
  movq   <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span><span class="token operator">]</span>      # Calculating X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">-</span> cexp() <span class="token operator">*</span> X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span>
  movq   <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   __muldc3
  movq   <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>
  movq   <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span><span class="token operator">]</span>, <span class="token register variable">xmm2</span>      # Save value in X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r14</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm3</span>
  movq   <span class="token register variable">xmm0</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>      # Calculating X<span class="token operator">[</span>i<span class="token operator">]</span> <span class="token operator">-</span><span class="token operator">=</span> X<span class="token operator">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span> <span class="token operator">-</span> X<span class="token operator">[</span>i<span class="token operator">]</span>
  movq   <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm2</span>
  subsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">r15</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  add    <span class="token register variable">r14</span>, <span class="token number">16</span>
  add    <span class="token register variable">r15</span>, <span class="token number">16</span>
  jmp    cooley_tukey_loop
<span class="token label function">cooley_tukey_end:</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  pop    <span class="token register variable">rbx</span>
<span class="token label function">cooley_tukey_return:</span>
  ret

# <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">bit_reverse:</span>
  push   <span class="token register variable">rbx</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>                  # Save parameters
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  shr    <span class="token register variable">r13</span>, <span class="token number">4</span>
  xor    <span class="token register variable">r14</span>, <span class="token register variable">r14</span>                  # Loop through all entries
<span class="token label function">bit_reverse_entries:</span>
  cmp    <span class="token register variable">r14</span>, <span class="token register variable">r13</span>
  je     bit_reverse_return
  cvtsi2sdq <span class="token register variable">xmm0</span>, <span class="token register variable">r13</span>              # Calculating the number of bit in N
  call   log2
  cvttsd2si <span class="token register variable">rcx</span>, <span class="token register variable">xmm0</span>
  mov    <span class="token register variable">rdi</span>, <span class="token number">1</span>                    # Calculating (<span class="token number">1</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> log2(N)) <span class="token operator">-</span> <span class="token number">1</span>
  sal    <span class="token register variable">edi</span>, <span class="token register variable">cl</span>
  sub    <span class="token register variable">edi</span>, <span class="token number">1</span>
  sub    <span class="token register variable">ecx</span>, <span class="token number">1</span>
  mov    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>
  mov    <span class="token register variable">r15</span>, <span class="token register variable">r14</span>
<span class="token label function">bit_reverse_loop:</span>
  sar    <span class="token register variable">r15</span>                       # Check if <span class="token register variable">r15</span> is <span class="token number">0</span>
  je     bit_reverse_reversed
  sal    <span class="token register variable">rax</span>, <span class="token number">1</span>                    # Calculating (<span class="token register variable">rax</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">1</span>) <span class="token operator">|</span> (<span class="token register variable">r15</span> <span class="token operator">&amp;</span> <span class="token number">1</span>)
  mov    <span class="token register variable">rsi</span>, <span class="token register variable">r15</span>
  and    <span class="token register variable">rsi</span>, <span class="token number">1</span>
  or     <span class="token register variable">rax</span>, <span class="token register variable">rsi</span>
  sub    <span class="token register variable">ecx</span>, <span class="token number">1</span>                    # Decrement bit count
  jmp    bit_reverse_loop
<span class="token label function">bit_reverse_reversed:</span>
  sal    <span class="token register variable">eax</span>, <span class="token register variable">cl</span>                   # Calculate (<span class="token register variable">rax</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token register variable">rcx</span>) <span class="token operator">&amp;</span> (<span class="token number">1</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> bit count)
  and    <span class="token register variable">rax</span>, <span class="token register variable">rdi</span>
  cmp    <span class="token register variable">rax</span>, <span class="token register variable">r14</span>                  # Check if <span class="token register variable">rax</span> is greater then <span class="token register variable">r14</span>
  jle    bit_reverse_no_swap       # If so then swap entries
  shl    <span class="token register variable">rax</span>, <span class="token number">4</span>                    # Times index by <span class="token number">16</span> to get bytes to entry
  shl    <span class="token register variable">r14</span>, <span class="token number">4</span>
  movaps <span class="token register variable">xmm0</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">rax</span><span class="token operator">]</span>
  movaps <span class="token register variable">xmm1</span>, XMMWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  movaps XMMWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r14</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  shr    <span class="token register variable">r14</span>, <span class="token number">4</span>
<span class="token label function">bit_reverse_no_swap:</span>
  add    <span class="token register variable">r14</span>, <span class="token number">1</span>
  jmp    bit_reverse_entries
<span class="token label function">bit_reverse_return:</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  pop    <span class="token register variable">rbx</span>
  ret

# <span class="token register variable">rdi</span> <span class="token operator">-</span> array ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array size
<span class="token label function">iterative_cooley_tukey:</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  push   <span class="token register variable">rbx</span>
  sub    <span class="token register variable">rsp</span>, <span class="token number">48</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  call   bit_reverse              # Bit reversing array
  sar    <span class="token register variable">r13</span>, <span class="token number">4</span>                   # Calculate log2(N)
  cvtsi2sdq <span class="token register variable">xmm0</span>, <span class="token register variable">r13</span>
  call   log2
  cvttsd2si <span class="token register variable">rax</span>, <span class="token register variable">xmm0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span><span class="token operator">]</span>, <span class="token register variable">rax</span>     # Save it to the stack
  mov    <span class="token register variable">r14</span>, <span class="token number">1</span>
<span class="token label function">iter_ct_loop_i:</span>
  cmp    <span class="token register variable">r14</span>, <span class="token register variable">rax</span>                 # Check if <span class="token register variable">r14</span> is greater then log2(N)
  jg     iter_ct_end_i
  movsd  <span class="token register variable">xmm0</span>, two                # Calculate stride <span class="token operator">=</span> <span class="token number">2</span>^(<span class="token register variable">r14</span>)
  cvtsi2sdq <span class="token register variable">xmm1</span>, <span class="token register variable">r14</span>
  call   pow
  cvttsd2si <span class="token register variable">r10</span>, <span class="token register variable">xmm0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">40</span><span class="token operator">]</span>, <span class="token register variable">r10</span># move stride to stack
  movsd  <span class="token register variable">xmm1</span>, two_pi             # Calculating cexp(<span class="token operator">-</span>2pi <span class="token operator">*</span> I <span class="token operator">/</span> stride)
  divsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm0</span>
  pxor   <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>
  call   cexp
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>  # Save it to stack
  movq   QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  xor    <span class="token register variable">r15</span>, <span class="token register variable">r15</span>
<span class="token label function">iter_ct_loop_j:</span>
  cmp    <span class="token register variable">r15</span>, <span class="token register variable">r13</span>                 # Check if <span class="token register variable">r15</span> is less then array size
  je     iter_ct_end_j
  movsd  <span class="token register variable">xmm4</span>, one                # Save <span class="token number">1</span> <span class="token operator">+</span> 0i to stack
  pxor   <span class="token register variable">xmm5</span>, <span class="token register variable">xmm5</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token operator">]</span>, <span class="token register variable">xmm4</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token operator">]</span>, <span class="token register variable">xmm5</span>
  xor    <span class="token register variable">rbx</span>, <span class="token register variable">rbx</span>
  mov    <span class="token register variable">rax</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">40</span><span class="token operator">]</span># Calculate stride <span class="token operator">/</span> <span class="token number">2</span>
  sar    <span class="token register variable">rax</span>, <span class="token number">1</span>
<span class="token label function">iter_ct_loop_k:</span>
  cmp    <span class="token register variable">rbx</span>, <span class="token register variable">rax</span>                 # Check if <span class="token register variable">rbx</span> is less then stride <span class="token operator">/</span> <span class="token number">2</span>
  je     iter_ct_end_k
  mov    <span class="token register variable">r8</span>, <span class="token register variable">r15</span>                  # Saving pointers to X<span class="token operator">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span> and X<span class="token operator">[</span>k <span class="token operator">+</span> j<span class="token operator">]</span>
  add    <span class="token register variable">r8</span>, <span class="token register variable">rbx</span>
  sal    <span class="token register variable">r8</span>, <span class="token number">4</span>
  mov    <span class="token register variable">r9</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">40</span><span class="token operator">]</span>
  sal    <span class="token register variable">r9</span>, <span class="token number">3</span>
  add    <span class="token register variable">r9</span>, <span class="token register variable">r8</span>
  lea    <span class="token register variable">r9</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r9</span><span class="token operator">]</span>
  lea    <span class="token register variable">r8</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token register variable">r8</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm0</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r9</span><span class="token operator">]</span>     # Calculate X<span class="token operator">[</span>k <span class="token operator">+</span> j<span class="token operator">]</span> <span class="token operator">-</span> v <span class="token operator">*</span> X<span class="token operator">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r9</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token operator">]</span>
  call   __muldc3
  movsd  <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">r9</span><span class="token operator">]</span>, <span class="token register variable">xmm2</span>     # Saving answer
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">r9</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm3</span>
  movsd  <span class="token register variable">xmm0</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span><span class="token operator">]</span>     # Calculating X<span class="token operator">[</span>k <span class="token operator">+</span> j<span class="token operator">]</span> <span class="token operator">-</span> (X<span class="token operator">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">]</span> <span class="token operator">-</span> X<span class="token operator">[</span>k <span class="token operator">+</span> j<span class="token operator">]</span>)
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm2</span>, <span class="token register variable">xmm0</span>
  subsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm2</span>
  subsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>     # Saving answer
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">r8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  movsd  <span class="token register variable">xmm0</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token operator">]</span> # Calculating v <span class="token operator">*</span> w
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm2</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm3</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token operator">]</span>
  call   __muldc3
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span> # Saving answer
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token operator">]</span>, <span class="token register variable">xmm1</span>
  add    <span class="token register variable">rbx</span>, <span class="token number">1</span>
  mov    <span class="token register variable">rax</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">40</span><span class="token operator">]</span>
  sar    <span class="token register variable">rax</span>, <span class="token number">1</span>
  jmp    iter_ct_loop_k
<span class="token label function">iter_ct_end_k:</span>
  add    <span class="token register variable">r15</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">40</span><span class="token operator">]</span>
  jmp    iter_ct_loop_j
<span class="token label function">iter_ct_end_j:</span>
  add    <span class="token register variable">r14</span>, <span class="token number">1</span>
  mov    <span class="token register variable">rax</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span><span class="token operator">]</span>
  jmp    iter_ct_loop_i
<span class="token label function">iter_ct_end_i:</span>
  add    <span class="token register variable">rsp</span>, <span class="token number">48</span>
  pop    <span class="token register variable">rbx</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  ret

# <span class="token register variable">rdi</span> <span class="token operator">-</span> array a ptr
# <span class="token register variable">rsi</span> <span class="token operator">-</span> array b ptr
# <span class="token register variable">rdx</span> <span class="token operator">-</span> array size
<span class="token label function">approx:</span>
  push   <span class="token register variable">r12</span>
  push   <span class="token register variable">r13</span>
  push   <span class="token register variable">r14</span>
  push   <span class="token register variable">r15</span>
  mov    <span class="token register variable">r12</span>, <span class="token register variable">rdi</span>
  mov    <span class="token register variable">r13</span>, <span class="token register variable">rsi</span>
  mov    <span class="token register variable">r14</span>, <span class="token register variable">rdx</span>
  lea    <span class="token register variable">r15</span>, <span class="token operator">[</span><span class="token register variable">rdi</span> <span class="token operator">+</span> <span class="token register variable">rdx</span><span class="token operator">]</span>
  sub    <span class="token register variable">rsp</span>, <span class="token number">8</span>
<span class="token label function">approx_loop:</span>
  cmp    <span class="token register variable">r12</span>, <span class="token register variable">r15</span>
  je     approx_return
  movsd  <span class="token register variable">xmm0</span>, QWORD PTR<span class="token operator">[</span><span class="token register variable">r13</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR<span class="token operator">[</span><span class="token register variable">r13</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   cabs
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movsd  <span class="token register variable">xmm0</span>, QWORD PTR<span class="token operator">[</span><span class="token register variable">r12</span><span class="token operator">]</span>
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR<span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>
  call   cabs
  movsd  <span class="token register variable">xmm1</span>, QWORD PTR <span class="token operator">[</span><span class="token register variable">rsp</span><span class="token operator">]</span>
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm1</span>
  mov    <span class="token register variable">rdi</span>, OFFSET fmt
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  add    <span class="token register variable">r12</span>, <span class="token number">16</span>
  add    <span class="token register variable">r13</span>, <span class="token number">16</span>
  jmp    approx_loop
<span class="token label function">approx_return:</span>
  add    <span class="token register variable">rsp</span>, <span class="token number">8</span>
  pop    <span class="token register variable">r15</span>
  pop    <span class="token register variable">r14</span>
  pop    <span class="token register variable">r13</span>
  pop    <span class="token register variable">r12</span>
  ret

<span class="token label function">main:</span>
  push   <span class="token register variable">r12</span>
  sub    <span class="token register variable">rsp</span>, <span class="token number">2048</span>
  mov    <span class="token register variable">rdi</span>, <span class="token number">0</span>
  call   time
  mov    <span class="token register variable">edi</span>, <span class="token register variable">eax</span>
  call   srand
  lea    <span class="token register variable">r12</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">1024</span><span class="token operator">]</span>
<span class="token label function">loop:</span>
  cmp    <span class="token register variable">r12</span>, <span class="token register variable">rsp</span>
  je     end_loop
  sub    <span class="token register variable">r12</span>, <span class="token number">16</span>
  call   rand
  cvtsi2sd <span class="token register variable">xmm0</span>, <span class="token register variable">rax</span>
  divsd  <span class="token register variable">xmm0</span>, rand_max
  lea    <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token number">1024</span><span class="token operator">]</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  movsd  QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span><span class="token operator">]</span>, <span class="token register variable">xmm0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">r12</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token number">0</span>
  mov    QWORD PTR <span class="token operator">[</span><span class="token register variable">rax</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">]</span>, <span class="token number">0</span>
  jmp    loop
<span class="token label function">end_loop:</span>
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">rsp</span>
  mov    <span class="token register variable">rsi</span>, <span class="token number">1024</span>
  call   iterative_cooley_tukey
  lea    <span class="token register variable">rdi</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">1024</span><span class="token operator">]</span>
  mov    <span class="token register variable">rsi</span>, <span class="token number">1024</span>
  call   cooley_tukey
  mov    <span class="token register variable">rdi</span>, <span class="token register variable">rsp</span>
  lea    <span class="token register variable">rsi</span>, <span class="token operator">[</span><span class="token register variable">rsp</span> <span class="token operator">+</span> <span class="token number">1024</span><span class="token operator">]</span>
  mov    <span class="token register variable">rdx</span>, <span class="token number">1024</span>
  call   approx
  xor    <span class="token register variable">rax</span>, <span class="token register variable">rax</span>
  add    <span class="token register variable">rsp</span>, <span class="token number">2048</span>
  pop    <span class="token register variable">r12</span>
  ret
</code></pre>
</div><div class="code-method-sample" data-lang="js" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">const</span> Complex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;complex.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">dft</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  <span class="token comment">// Initialize an array with N elements, filled with 0s</span>
  <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">temp<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Reduce x into the sum of x_k * exp(-2*sqrt(-1)*pi*i*k/N)</span>
      <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> k</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> i <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Start accumulating from 0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> half <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token constant">N</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">N</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Extract even and odd indexed elements with remainder mod 2</span>
  <span class="token keyword">const</span> evens <span class="token operator">=</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token punctuation">(</span>idx <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> odds <span class="token operator">=</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> idx <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Fill an array with null values</span>
  <span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> half<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arg <span class="token operator">=</span> odds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> evens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    temp<span class="token punctuation">[</span>i <span class="token operator">+</span> half<span class="token punctuation">]</span> <span class="token operator">=</span> evens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bit_reverse_idxs</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> twice <span class="token operator">=</span> <span class="token function">bit_reverse_idxs</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> twice<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>twice<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bit_reverse</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> indexes <span class="token operator">=</span> <span class="token function">bit_reverse_idxs</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">log2</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">[</span>indexes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Assumes log_2(N) is an integer</span>
<span class="token keyword">function</span> <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  x <span class="token operator">=</span> <span class="token function">bit_reverse</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> Math<span class="token punctuation">.</span><span class="token function">log2</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> stride <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> i<span class="token punctuation">;</span>
    <span class="token keyword">const</span> half <span class="token operator">=</span> stride <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> stride<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token constant">N</span><span class="token punctuation">;</span> j <span class="token operator">+=</span> stride<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> half<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// perform butterfly multiplication</span>
        x<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> half<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> half<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>k <span class="token operator">+</span> j <span class="token operator">+</span> half<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>k <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// accumulate v as powers of w</span>
        v <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Check if two arrays of complex numbers are approximately equal</span>
<span class="token keyword">function</span> <span class="token function">approx</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> tol <span class="token operator">=</span> <span class="token number">1e-12</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> diff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    diff <span class="token operator">+=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> diff <span class="token operator">&lt;</span> tol<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">X</span> <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Complex</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">Y</span> <span class="token operator">=</span> <span class="token function">cooley_tukey</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">Z</span> <span class="token operator">=</span> <span class="token function">iterative_cooley_tukey</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token function">dft</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Check if the calculations are correct within a small tolerance</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Cooley tukey approximation is accurate: &quot;</span><span class="token punctuation">,</span> <span class="token function">approx</span><span class="token punctuation">(</span><span class="token constant">Y</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Iterative cooley tukey approximation is accurate: &quot;</span><span class="token punctuation">,</span> <span class="token function">approx</span><span class="token punctuation">(</span><span class="token constant">Z</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div></div></div>

<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/master/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><p><img class="center" src="../cc/CC-BY-SA_icon.svg"></p></a></p>
<h5 id="imagesgraphics">Images/Graphics</h5>
<ul>
<li>The image &quot;<a href="res/FT_example.png">FTexample</a>&quot; was created by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licenced under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</li>
<li>The image &quot;<a href="res/radix-2screen_positive.jpg">radix2positive</a>&quot; was created by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licenced under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</li>
<li>The image &quot;<a href="res/radix-2screen.jpg">radix2</a>&quot; was created by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licenced under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</li>
<li>The image &quot;<a href="res/radix-8screen.jpg">radix8</a>&quot; was created by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licenced under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</li>
<li>The image &quot;<a href="https://en.wikipedia.org/wiki/Butterfly_diagram#/media/File:DIT-FFT-butterfly.png" target="_blank">DIT-FFT-butterfly</a>&quot; was created by Virens and is licenced under the <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons Attribution 3.0 Unported License</a>.</li>
</ul>
<h5 id="pull-requests">Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560" target="_blank">#560</a>), the following pull requests have modified the text or graphics of this chapter:</p>
<ul>
<li>none</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../graham_scan/graham_scan.html" class="navigation navigation-prev " aria-label="Previous page: Graham Scan">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../decision_problems/decision_problems.html" class="navigation navigation-next " aria-label="Next page: Decision Problems">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"FFT","level":"1.13","depth":1,"next":{"title":"Decision Problems","level":"1.14","depth":1,"path":"contents/decision_problems/decision_problems.md","ref":"contents/decision_problems/decision_problems.md","articles":[{"title":"Stable Marriage Problem","level":"1.14.1","depth":2,"path":"contents/stable_marriage_problem/stable_marriage_problem.md","ref":"contents/stable_marriage_problem/stable_marriage_problem.md","articles":[]}]},"previous":{"title":"Graham Scan","level":"1.12.1.2","depth":3,"path":"contents/graham_scan/graham_scan.md","ref":"contents/graham_scan/graham_scan.md","articles":[]},"dir":"ltr"},"config":{"plugins":["fontsettings","mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","ga","bulk-redirect","prism","-highlight"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"ps1","name":"PowerShell"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"},{"lang":"vim","name":"VimL"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"ga":{"configuration":"auto","token":"UA-118252470-1"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}},{"citationKey":"GNUPLOT","entryType":"MISC","entryTags":{"TITLE":"Gnuplot 5.0: An Interactive Plotting Program, Official Gnuplot Documentation","AUTHOR":"Williams, T and Kelley, C","YEAR":"2015"}},{"citationKey":"BEDE725","entryType":"BOOK","entryTags":{"TITLE":"Bede, the Reckoning of Time","AUTHOR":"Venerabilis, Beda and others","VOLUME":"29","YEAR":"1999","PUBLISHER":"Liverpool University Press"}},{"citationKey":"DICTCOMPUTUS","entryType":"MISC","entryTags":{"TITLE":"Dictionary.com definition of computus","URL":"https://www.merriam-webster.com/dictionary/computus","YEAR":"2020"}},{"citationKey":"COMPUTUS1876","entryType":"ARTICLE","entryTags":{"TITLE":"To find Easter: a new York correspondent sends us the following","AUTHOR":"unknown","JOURNAL":"Nature","YEAR":"1876"}},{"citationKey":"BIEN2004","entryType":"ARTICLE","entryTags":{"TITLE":"Gauss and beyond: The making of Easter algorithms","AUTHOR":"Bien, Reinhold","JOURNAL":"Archive for history of exact sciences","VOLUME":"58","NUMBER":"5","PAGES":"439--452","YEAR":"2004","PUBLISHER":"Springer"}},{"citationKey":"SERVOIS","entryType":"INPROCEEDINGS","entryTags":{"TITLE":"84 Calendrier","AUTHOR":"Servois, M","BOOKTITLE":"Annales de MathÃ©matiques pures et appliquÃ©es","VOLUME":"4","NUMBER":"1813-1814","PAGES":"84--90"}},{"citationKey":"STANDISH2004","entryType":"ARTICLE","entryTags":{"TITLE":"The astronomical unit now","AUTHOR":"Standish, EM","JOURNAL":"Proceedings of the International Astronomical Union","VOLUME":"2004","NUMBER":"IAUC196","PAGES":"163--179","YEAR":"2004","PUBLISHER":"Cambridge University Press"}},{"citationKey":"LUNAR_MONTH_WIKI","entryType":"MISC","entryTags":{"TITLE":"Wikipedia: Lunar Month","URL":"https://en.wikipedia.org/wiki/Lunar_month","YEAR":"2020"}}],"gitbook":"3.x.x"},"file":{"path":"contents/cooley_tukey/cooley_tukey.md","mtime":"2020-05-05T22:03:00.478Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-05T22:03:50.555Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-api-language-selector/api-language-selector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

